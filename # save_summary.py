# save_summary.py
import os

# 保存したい説明文を複数行文字列として定義します
summary_text = """
### `mercari_dorekai` プロジェクトのファイル説明書

このプロジェクトは、フリマアプリ（メルカリ、ラクマ、Yahoo!フリマ）での商品管理や出品を自動化するためのPythonスクリプト群です。

#### ■ データ準備・収集 (まずこれを実行)

1.  **`dorekai_scraper.py`**
    *   **役割**: ラクマとメルカリから最新の商品情報を集めて、整理・比較するスクリプト。
    *   **主な処理**:
        *   ラクマのショップページから全商品の情報を取得します。
        *   メルカリの出品データ（`product_data_*.csv`）を読み込みます。
        *   メルカリで売り切れた商品をラクマから削除するための「削除」フラグを付けます。
        *   `products_rakuma.csv` と `products_mercari.csv` という2つの重要なCSVファイルを作成・更新します。

2.  **`mercari_dorekai.py`**
    *   **役割**: メルカリから商品画像をダウンロードするスクリプト。
    *   **主な処理**:
        *   メルカリの出品データ（`product_data_*.csv`）を読み込み、出品準備ができた商品（ステータスが'2'）を特定します。
        *   対象商品のページにアクセスし、すべての商品画像を `mercari_images` フォルダにダウンロードします。

#### ■ 出品・更新 (データ準備後に実行)

3.  **`rakuma_exhibitor.py`**
    *   **役割**: ラクマへ新規商品を出品するスクリプト。
    *   **主な処理**:
        *   `dorekai_scraper.py` が作成したCSVを元に、メルカリにはあってラクマにはまだない商品を特定します。
        *   ブラウザ（Firefox）を自動操作して、ラクマの出品ページを開きます。
        *   画像、商品名、説明、価格などを自動で入力し、出品処理を実行します。

4.  **`rakuma_updater.py`**
    *   **役割**: ラクマに出品済みの商品情報を一括で更新するスクリプト。
    *   **主な処理**:
        *   ブラウザを自動操作し、各商品の編集ページを開きます。
        *   古い画像をすべて削除し、ダウンロード済みの新しい画像を再アップロードします。
        *   商品説明や価格などを最新の情報に更新します。
        *   配送方法や発送日数も指定された内容に更新します。

5.  **`rakuma_shipping_updater.py`**
    *   **役割**: ラクマ商品の配送方法だけをまとめて更新するスクリプト。
    *   **主な処理**:
        *   各商品の編集ページを開き、配送方法を「かんたんラクマパック(日本郵便)」に設定し直します。

6.  **`yahoofleama_exhibitor.py`**
    *   **役割**: Yahoo!フリマへ新規商品を出品するスクリプト（PC画面操作）。
    *   **主な処理**:
        *   BlueStacks（Androidエミュレータ）の画面を直接操作します。
        *   あらかじめ撮影しておいたボタンの画像（`images`フォルダ内）を元に、出品ボタンやカテゴリ選択などを自動でクリックします。
        *   商品名や説明はキーボード入力で自動で行います。

7.  **`yahoofleama_updater.py`**
    *   **役割**: Yahoo!フリマの商品を再出品するスクリプト（PC画面操作）。
    *   **主な処理**:
        *   BlueStacksの画面を操作し、「再出品」ボタンと「出品する」ボタンをクリックします。

8.  **`mercari_updater.py`**
    *   **役割**: メルカリShopsの在庫数を更新するためのCSVを作成するスクリプト。
    *   **主な処理**:
        *   在庫マスターファイル（`products.xlsx`）を読み込みます。
        *   メルカリShopsからダウンロードした出品テンプレートCSVの在庫数欄を、マスターファイルの内容で上書きします。
        *   アップロード用の新しいCSVファイル（`mercari_upload.csv`）を生成します。

#### ■ 通知・その他

9.  **`notify.py`**
    *   **役割**: 注文通知をLINEに送信するスクリプト。
    *   **主な処理**:
        *   Gmailにログインし、ラクマやメルカリShopsからの新規注文メールをチェックします。
        *   新しい注文があれば、商品名や価格などの情報をLINEグループに通知します。

10. **`rename_files.py`**
    *   **役割**: ファイル名を修正する便利ツール。
    *   **主な処理**:
        *   `mercari_images` フォルダ内にあるファイル名のおかしな部分（例: `...jpg@jpg`）を正しい形式に修正します。
"""

# ファイル名
output_filename = "project_summary.txt"

try:
    # withステートメントを使い、安全にファイルを書き込みます
    # encoding='utf-8' を指定することで、文字化けを防ぎます
    with open(output_filename, "w", encoding="utf-8") as f:
        # 文字列の先頭にある不要なインデントを削除して書き込みます
        f.write(summary_text.strip())
    
    print(f"✅ 説明を '{os.path.abspath(output_filename)}' に保存しました。")

except IOError as e:
    print(f"❌ ファイルの書き込み中にエラーが発生しました: {e}")

